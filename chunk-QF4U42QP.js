import{g as c,k as h,p as n,s as l,va as m}from"./chunk-YPJVWY4P.js";var u=class{constructor(s,p,t,e){this.id=0,this.id=s,this.content=p,this.style=t||"is-light is-info",this.vanish=e||0}},d=(()=>{let s=class s{constructor(){this.messagesArray=[],this.i=0}pushNewToasty(t,e,i){let a=new u(this.i,t,e);this.messagesArray.push(a),this.i+=1,i&&i>0&&setTimeout(()=>{this.dismissToasty(a.id)},i*1e3)}fetchAllToasties(){return this.messagesArray}dismissToasty(t){let e=this.messagesArray.findIndex(i=>i.id==t);e!=-1&&this.messagesArray.splice(e,1)}};s.\u0275fac=function(e){return new(e||s)},s.\u0275prov=n({token:s,factory:s.\u0275fac,providedIn:"root"});let r=s;return r})();var D=(()=>{let s=class s{constructor(t){this.http=t,this.authenticated=!1,this.authListener=new c({username:"",isAuthenticated:!1})}signInUser(t,e){let i={username:t,password:e};return this.http.post("/api/login",i).pipe(h(a=>{this.userJWT=a.token,this.authenticated=!0,this.username=t;let o=new Date;return this.saveLocalAuthData(a.token,new Date(o.getTime()+a.expiresIn*1e3),t),this.authListener.next({username:t,isAuthenticated:!0}),{username:t,isAuthenticated:!0}}))}signUpUser(t,e){let i={username:t,password:e};return this.http.post("/api/register",i).pipe(h(a=>{this.userJWT=a.token,this.authenticated=!0,this.username=t;let o=new Date;return this.saveLocalAuthData(a.token,new Date(o.getTime()+a.expiresIn*1e3),t),this.authListener.next({username:t,isAuthenticated:!0}),{username:t,isAuthenticated:!0}}))}signOut(){this.clearLocalAuthData(),this.authListener.next({username:"",isAuthenticated:!1})}saveLocalAuthData(t,e,i){localStorage.setItem("token",t),localStorage.setItem("expiresAt",e.toISOString()),localStorage.setItem("username",i)}clearLocalAuthData(){localStorage.removeItem("token"),localStorage.removeItem("expiresAt"),localStorage.removeItem("username")}fetchLocalAuthData(){let t=localStorage.getItem("token"),e=localStorage.getItem("expiresAt"),i=localStorage.getItem("username");if(!(!t||!e||!i))return{token:t,expiresAt:e,username:i}}loadSession(){let t=this.fetchLocalAuthData();if(t){if(new Date>new Date(t.expiresAt)){this.clearLocalAuthData();return}this.userJWT=t.token,this.username=t.username,this.authenticated=!0,this.authListener.next({username:this.username,isAuthenticated:!0})}}isAuthenticated(){return this.authenticated}getUsername(){return this.username}getAuthListener(){return this.authListener.asObservable()}getJWT(){return this.userJWT}};s.\u0275fac=function(e){return new(e||s)(l(m))},s.\u0275prov=n({token:s,factory:s.\u0275fac,providedIn:"root"});let r=s;return r})();export{d as a,D as b};
